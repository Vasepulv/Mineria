---
title: "Laboratorio 3.1 - Clustering en R"
author: "** MODIFICAR AQUí, INDICANDO NOMBRE DE LOS INTEGRANTES **"
date: "Octubre 2019"
output: 
  html_document: 
    theme: default
    toc: yes
---


# Instrucciones

1. Trabaje en equipos de dos personas. Salvo excepciones, no se corregirá entregas con menos de dos integrantes.

2. Modifique este archivo `.Rmd` agregando sus respuestas donde corresponda.

3. Para cada pregunta, cuando corresponda, **incluya el código fuente que utilizó para llegar a su respuesta**.

4. Al final de la clase, **genere un archivo HTML usando RStudio** y súbalo a U-Cursos.
   Basta con que uno de los integrantes haga la entrega. Si ambos hacen una entrega en U-Cursos, se revisará cualquiera de éstas.

# Laboratorio

Para este laboratorio usaremos el dataset de cantidad de denuncias por 100 mil habitantes por tipo de delito desde el año 2001 al 2016 en Chile (Fuente: http://www.seguridadpublica.gov.cl/estadisticas/tasa-de-denuncias-y-detenciones/delitos-de-mayor-connotacion-social-series-de-datos-2001-2017/). 

Cargue el siguiente dataset:

```{r}
data <- read.table('https://users.dcc.uchile.cl/~hsarmien/mineria/datasets/denuncias-2001-2016.txt')
```

Utilizaremos sólo los datos del 2005. Ejecute las siguientes líneas de código para filtrar los datos:

```{r, eval=T, results=F}
anio <- 2005
x <- data[data$anio == anio, ]
rownames(x) <- x$comuna
x <- x[, c(-1, -2)]
head(x)
```


## Parte 1: Exploración de datos

**1.1.** Descripción de los datos: explique brevemente qué representa cada instancia (fila) y atributo (columna) y estime el número de observaciones que hay en el dataset.

```{r}
Cada fila
dim(x)
```

**1.2.** Genere un boxplot a partir de los datos y describa tres características de estos basándose en el gráfico. Por ejemplo, explicar sobre la mediana de los datos, distribución de los datos, entre otros.

```{r}
boxplot(x)
```


## Parte 2: K-means

**2.1.** Describa qué es lo que hace cada línea del código adjunto. ¿Varían los resultados para diferentes ejecuciones? Si su respuesta es sí, ¿por qué?

```{r eval=F}
km.out <- kmeans(x, 3, nstart = 20)
km.out$centers
hc.complete <- hclust(dist(x), method = "complete")
hc.single <- hclust(dist(x), method = "single")
hc.average <- hclust(dist(x), method = "average")
metodo = cutree(hc.complete, k=10)
scale(dist(x))
plot(hclust(dist(x), method = "complete"), main = "HC complete (scaled features)")
plot (metodo)
K=4
rect.hclust(metodo, k = K, border = 2:5)
```
```

**2.2.** ¿Cómo podría evitar los resultados variables de `K-means`?


**2.3.** ¿Cómo podría encontrar *outliers* en los datos usando `K-means`? Describa su propuesta y muestre un par de ejemplos con distintos números de clusters.

```{r eval=F}
km.out <- kmeans(x, 1, nstart = 5)
km.out$centers
```

## Parte 3: Clustering Jerárquico Aglomerativo

**3.1** Usando el dataframe `x`, ejecute cada uno de los 3 métodos de clustering jerárquico: `complete`, `single` y `average`, y visualice los dendrogramas formados. Adjunte código necesario.

```{r}
hc.complete <- hclust(dist(x), method = "complete")
hc.single <- hclust(dist(x), method = "single")
hc.average <- hclust(dist(x), method = "average")
```

**3.2.** Indique dónde haría los cortes en cada método (complete, single, average) basado en un número K de clusters. Para visualizar los cortes complete el siguiente código para cada método y el K elegido en cada caso.
```{r}
metodo = hc.complete(k=4)
#K = ...
#plot(metodo)
#rect.hclust(metodo, k = K, border = 2:5)
```

**3.3.** ¿Cómo sería posible encontrar *outliers* en los datos usando clustering jerárquico? Basta con que comente su respuesta.


**3.4.** Describa una ventaja y una desventaja de emplear cada uno de los métodos de clustering vistos en este laboratorio (k-means y jerárquico aglomerativo).

